<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirect | kot.la</title>
    <script>
        /*PATH*/
        path = document.location.pathname
        if (path.startsWith("/")) {
            path = path.replace("/","")
        }
        path = path.replace(/\.[^/.]+$/, "")
        path = path.toLowerCase()
        alert(path)


        async function getIssues() {
            /*REQUESTS*/
            let headersList = {
            "Accept": "*/*",
            }

            let response = await fetch("https://api.github.com/repos/GameDesert/redirect/issues", { 
            method: "GET",
            headers: headersList
            });

            let data = await response.json();
            console.log(data);
            
            /*ID ISSUES*/
            var issue_count = await data.length;
            console.log(issue_count)
            for (var issue = 0; issue < issue_count; issue++) {
                if (data[issue]["user"]["id"] == 56128805) {
                    if (data[issue]["title"] == path) {
                        if (/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/.test(data[issue]["body"]) == true) {
                            window.location.replace(data[issue]["body"]);
                        }
                    }
                }
                //Do something
            }

        }
        
        getIssues()
    </script>
</head>
<body>
    
</body>
</html>